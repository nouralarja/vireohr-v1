{"dependencies":[{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":111,"column":43,"index":2995}}],"key":"ohGilxjVqjyE1GooDVDt9OYg9x0="}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":111,"column":43,"index":2995}}],"key":"V6GYoXnblvuuGHJNMy7MHyaunsU="}},{"name":"./CircularBuffer","data":{"asyncType":null,"locs":[{"start":{"line":8,"column":45,"index":152},"end":{"line":8,"column":72,"index":179}}],"key":"yhh9BZ23Anx9K68Ta7WcM9DWmpE="}},{"name":"./LeastSquareSolver","data":{"asyncType":null,"locs":[{"start":{"line":10,"column":48,"index":231},"end":{"line":10,"column":78,"index":261}}],"key":"EHof73iRGSr7O/L6wXn0Ha05yYU="}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _classCallCheck = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/classCallCheck\");\n  var _createClass = _$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/createClass\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _CircularBuffer = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"./CircularBuffer\"));\n  var _LeastSquareSolver = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"./LeastSquareSolver\"));\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n    return obj;\n  }\n  var VelocityTracker = /*#__PURE__*/function () {\n    function VelocityTracker() {\n      _classCallCheck(this, VelocityTracker);\n      _defineProperty(this, \"assumePointerMoveStoppedMilliseconds\", 40);\n      _defineProperty(this, \"historySize\", 20);\n      _defineProperty(this, \"horizonMilliseconds\", 300);\n      _defineProperty(this, \"minSampleSize\", 3);\n      _defineProperty(this, \"samples\", void 0);\n      this.samples = new _CircularBuffer.default(this.historySize);\n    }\n    return _createClass(VelocityTracker, [{\n      key: \"add\",\n      value: function add(event) {\n        this.samples.push(event);\n      } /// Returns an estimate of the velocity of the object being tracked by the\n      /// tracker given the current information available to the tracker.\n      ///\n      /// Information is added using [addPosition].\n      ///\n      /// Returns null if there is no data on which to base an estimate.\n    }, {\n      key: \"getVelocityEstimate\",\n      value: function getVelocityEstimate() {\n        var x = [];\n        var y = [];\n        var w = [];\n        var time = [];\n        var sampleCount = 0;\n        var index = this.samples.size - 1;\n        var newestSample = this.samples.get(index);\n        if (!newestSample) {\n          return null;\n        }\n        var previousSample = newestSample; // Starting with the most recent PointAtTime sample, iterate backwards while\n        // the samples represent continuous motion.\n\n        while (sampleCount < this.samples.size) {\n          var sample = this.samples.get(index);\n          var age = newestSample.time - sample.time;\n          var delta = Math.abs(sample.time - previousSample.time);\n          previousSample = sample;\n          if (age > this.horizonMilliseconds || delta > this.assumePointerMoveStoppedMilliseconds) {\n            break;\n          }\n          x.push(sample.x);\n          y.push(sample.y);\n          w.push(1);\n          time.push(-age);\n          sampleCount++;\n          index--;\n        }\n        if (sampleCount >= this.minSampleSize) {\n          var xSolver = new _LeastSquareSolver.default(time, x, w);\n          var xFit = xSolver.solve(2);\n          if (xFit !== null) {\n            var ySolver = new _LeastSquareSolver.default(time, y, w);\n            var yFit = ySolver.solve(2);\n            if (yFit !== null) {\n              var xVelocity = xFit.coefficients[1] * 1000;\n              var yVelocity = yFit.coefficients[1] * 1000;\n              return [xVelocity, yVelocity];\n            }\n          }\n        }\n        return null;\n      }\n    }, {\n      key: \"getVelocity\",\n      value: function getVelocity() {\n        var estimate = this.getVelocityEstimate();\n        if (estimate !== null) {\n          return estimate;\n        }\n        return [0, 0];\n      }\n    }, {\n      key: \"reset\",\n      value: function reset() {\n        this.samples.clear();\n      }\n    }]);\n  }();\n  exports.default = VelocityTracker;\n});","lineCount":113,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_classCallCheck"],[4,21,1,13],[4,24,1,13,"_$$_REQUIRE"],[4,35,1,13],[4,36,1,13,"_dependencyMap"],[4,50,1,13],[5,2,1,13],[5,6,1,13,"_createClass"],[5,18,1,13],[5,21,1,13,"_$$_REQUIRE"],[5,32,1,13],[5,33,1,13,"_dependencyMap"],[5,47,1,13],[6,2,3,0,"Object"],[6,8,3,6],[6,9,3,7,"defineProperty"],[6,23,3,21],[6,24,3,22,"exports"],[6,31,3,29],[6,33,3,31],[6,45,3,43],[6,47,3,45],[7,4,4,2,"value"],[7,9,4,7],[7,11,4,9],[8,2,5,0],[8,3,5,1],[8,4,5,2],[9,2,6,0,"exports"],[9,9,6,7],[9,10,6,8,"default"],[9,17,6,15],[9,20,6,18],[9,25,6,23],[9,26,6,24],[10,2,8,0],[10,6,8,4,"_CircularBuffer"],[10,21,8,19],[10,24,8,22,"_interopRequireDefault"],[10,46,8,44],[10,47,8,45,"require"],[10,58,8,52],[10,59,8,52,"_dependencyMap"],[10,73,8,52],[10,96,8,71],[10,97,8,72],[10,98,8,73],[11,2,10,0],[11,6,10,4,"_LeastSquareSolver"],[11,24,10,22],[11,27,10,25,"_interopRequireDefault"],[11,49,10,47],[11,50,10,48,"require"],[11,61,10,55],[11,62,10,55,"_dependencyMap"],[11,76,10,55],[11,102,10,77],[11,103,10,78],[11,104,10,79],[12,2,12,0],[12,11,12,9,"_interopRequireDefault"],[12,33,12,31,"_interopRequireDefault"],[12,34,12,32,"obj"],[12,37,12,35],[12,39,12,37],[13,4,12,39],[13,11,12,46,"obj"],[13,14,12,49],[13,18,12,53,"obj"],[13,21,12,56],[13,22,12,57,"__esModule"],[13,32,12,67],[13,35,12,70,"obj"],[13,38,12,73],[13,41,12,76],[14,6,12,78,"default"],[14,13,12,85],[14,15,12,87,"obj"],[15,4,12,91],[15,5,12,92],[16,2,12,94],[17,2,14,0],[17,11,14,9,"_defineProperty"],[17,26,14,24,"_defineProperty"],[17,27,14,25,"obj"],[17,30,14,28],[17,32,14,30,"key"],[17,35,14,33],[17,37,14,35,"value"],[17,42,14,40],[17,44,14,42],[18,4,14,44],[18,8,14,48,"key"],[18,11,14,51],[18,15,14,55,"obj"],[18,18,14,58],[18,20,14,60],[19,6,14,62,"Object"],[19,12,14,68],[19,13,14,69,"defineProperty"],[19,27,14,83],[19,28,14,84,"obj"],[19,31,14,87],[19,33,14,89,"key"],[19,36,14,92],[19,38,14,94],[20,8,14,96,"value"],[20,13,14,101],[20,15,14,103,"value"],[20,20,14,108],[21,8,14,110,"enumerable"],[21,18,14,120],[21,20,14,122],[21,24,14,126],[22,8,14,128,"configurable"],[22,20,14,140],[22,22,14,142],[22,26,14,146],[23,8,14,148,"writable"],[23,16,14,156],[23,18,14,158],[24,6,14,163],[24,7,14,164],[24,8,14,165],[25,4,14,167],[25,5,14,168],[25,11,14,174],[26,6,14,176,"obj"],[26,9,14,179],[26,10,14,180,"key"],[26,13,14,183],[26,14,14,184],[26,17,14,187,"value"],[26,22,14,192],[27,4,14,194],[28,4,14,196],[28,11,14,203,"obj"],[28,14,14,206],[29,2,14,208],[30,2,14,209],[30,6,16,6,"VelocityTracker"],[30,21,16,21],[31,4,17,2],[31,13,17,2,"VelocityTracker"],[31,29,17,2],[31,31,17,16],[32,6,17,16,"_classCallCheck"],[32,21,17,16],[32,28,17,16,"VelocityTracker"],[32,43,17,16],[33,6,18,4,"_defineProperty"],[33,21,18,19],[33,22,18,20],[33,26,18,24],[33,28,18,26],[33,66,18,64],[33,68,18,66],[33,70,18,68],[33,71,18,69],[34,6,20,4,"_defineProperty"],[34,21,20,19],[34,22,20,20],[34,26,20,24],[34,28,20,26],[34,41,20,39],[34,43,20,41],[34,45,20,43],[34,46,20,44],[35,6,22,4,"_defineProperty"],[35,21,22,19],[35,22,22,20],[35,26,22,24],[35,28,22,26],[35,49,22,47],[35,51,22,49],[35,54,22,52],[35,55,22,53],[36,6,24,4,"_defineProperty"],[36,21,24,19],[36,22,24,20],[36,26,24,24],[36,28,24,26],[36,43,24,41],[36,45,24,43],[36,46,24,44],[36,47,24,45],[37,6,26,4,"_defineProperty"],[37,21,26,19],[37,22,26,20],[37,26,26,24],[37,28,26,26],[37,37,26,35],[37,39,26,37],[37,44,26,42],[37,45,26,43],[37,46,26,44],[38,6,28,4],[38,10,28,8],[38,11,28,9,"samples"],[38,18,28,16],[38,21,28,19],[38,25,28,23,"_CircularBuffer"],[38,40,28,38],[38,41,28,39,"default"],[38,48,28,46],[38,49,28,47],[38,53,28,51],[38,54,28,52,"historySize"],[38,65,28,63],[38,66,28,64],[39,4,29,2],[40,4,29,3],[40,11,29,3,"_createClass"],[40,23,29,3],[40,24,29,3,"VelocityTracker"],[40,39,29,3],[41,6,29,3,"key"],[41,9,29,3],[42,6,29,3,"value"],[42,11,29,3],[42,13,31,2],[42,22,31,2,"add"],[42,25,31,5,"add"],[42,26,31,6,"event"],[42,31,31,11],[42,33,31,13],[43,8,32,4],[43,12,32,8],[43,13,32,9,"samples"],[43,20,32,16],[43,21,32,17,"push"],[43,25,32,21],[43,26,32,22,"event"],[43,31,32,27],[43,32,32,28],[44,6,33,2],[44,7,33,3],[44,8,33,4],[45,6,34,2],[46,6,35,2],[47,6,36,2],[48,6,37,2],[49,6,38,2],[50,4,38,2],[51,6,38,2,"key"],[51,9,38,2],[52,6,38,2,"value"],[52,11,38,2],[52,13,41,2],[52,22,41,2,"getVelocityEstimate"],[52,41,41,21,"getVelocityEstimate"],[52,42,41,21],[52,44,41,24],[53,8,42,4],[53,12,42,10,"x"],[53,13,42,11],[53,16,42,14],[53,18,42,16],[54,8,43,4],[54,12,43,10,"y"],[54,13,43,11],[54,16,43,14],[54,18,43,16],[55,8,44,4],[55,12,44,10,"w"],[55,13,44,11],[55,16,44,14],[55,18,44,16],[56,8,45,4],[56,12,45,10,"time"],[56,16,45,14],[56,19,45,17],[56,21,45,19],[57,8,46,4],[57,12,46,8,"sampleCount"],[57,23,46,19],[57,26,46,22],[57,27,46,23],[58,8,47,4],[58,12,47,8,"index"],[58,17,47,13],[58,20,47,16],[58,24,47,20],[58,25,47,21,"samples"],[58,32,47,28],[58,33,47,29,"size"],[58,37,47,33],[58,40,47,36],[58,41,47,37],[59,8,48,4],[59,12,48,10,"newestSample"],[59,24,48,22],[59,27,48,25],[59,31,48,29],[59,32,48,30,"samples"],[59,39,48,37],[59,40,48,38,"get"],[59,43,48,41],[59,44,48,42,"index"],[59,49,48,47],[59,50,48,48],[60,8,50,4],[60,12,50,8],[60,13,50,9,"newestSample"],[60,25,50,21],[60,27,50,23],[61,10,51,6],[61,17,51,13],[61,21,51,17],[62,8,52,4],[63,8,54,4],[63,12,54,8,"previousSample"],[63,26,54,22],[63,29,54,25,"newestSample"],[63,41,54,37],[63,42,54,38],[63,43,54,39],[64,8,55,4],[66,8,57,4],[66,15,57,11,"sampleCount"],[66,26,57,22],[66,29,57,25],[66,33,57,29],[66,34,57,30,"samples"],[66,41,57,37],[66,42,57,38,"size"],[66,46,57,42],[66,48,57,44],[67,10,58,6],[67,14,58,12,"sample"],[67,20,58,18],[67,23,58,21],[67,27,58,25],[67,28,58,26,"samples"],[67,35,58,33],[67,36,58,34,"get"],[67,39,58,37],[67,40,58,38,"index"],[67,45,58,43],[67,46,58,44],[68,10,59,6],[68,14,59,12,"age"],[68,17,59,15],[68,20,59,18,"newestSample"],[68,32,59,30],[68,33,59,31,"time"],[68,37,59,35],[68,40,59,38,"sample"],[68,46,59,44],[68,47,59,45,"time"],[68,51,59,49],[69,10,60,6],[69,14,60,12,"delta"],[69,19,60,17],[69,22,60,20,"Math"],[69,26,60,24],[69,27,60,25,"abs"],[69,30,60,28],[69,31,60,29,"sample"],[69,37,60,35],[69,38,60,36,"time"],[69,42,60,40],[69,45,60,43,"previousSample"],[69,59,60,57],[69,60,60,58,"time"],[69,64,60,62],[69,65,60,63],[70,10,61,6,"previousSample"],[70,24,61,20],[70,27,61,23,"sample"],[70,33,61,29],[71,10,63,6],[71,14,63,10,"age"],[71,17,63,13],[71,20,63,16],[71,24,63,20],[71,25,63,21,"horizonMilliseconds"],[71,44,63,40],[71,48,63,44,"delta"],[71,53,63,49],[71,56,63,52],[71,60,63,56],[71,61,63,57,"assumePointerMoveStoppedMilliseconds"],[71,97,63,93],[71,99,63,95],[72,12,64,8],[73,10,65,6],[74,10,67,6,"x"],[74,11,67,7],[74,12,67,8,"push"],[74,16,67,12],[74,17,67,13,"sample"],[74,23,67,19],[74,24,67,20,"x"],[74,25,67,21],[74,26,67,22],[75,10,68,6,"y"],[75,11,68,7],[75,12,68,8,"push"],[75,16,68,12],[75,17,68,13,"sample"],[75,23,68,19],[75,24,68,20,"y"],[75,25,68,21],[75,26,68,22],[76,10,69,6,"w"],[76,11,69,7],[76,12,69,8,"push"],[76,16,69,12],[76,17,69,13],[76,18,69,14],[76,19,69,15],[77,10,70,6,"time"],[77,14,70,10],[77,15,70,11,"push"],[77,19,70,15],[77,20,70,16],[77,21,70,17,"age"],[77,24,70,20],[77,25,70,21],[78,10,71,6,"sampleCount"],[78,21,71,17],[78,23,71,19],[79,10,72,6,"index"],[79,15,72,11],[79,17,72,13],[80,8,73,4],[81,8,75,4],[81,12,75,8,"sampleCount"],[81,23,75,19],[81,27,75,23],[81,31,75,27],[81,32,75,28,"minSampleSize"],[81,45,75,41],[81,47,75,43],[82,10,76,6],[82,14,76,12,"xSolver"],[82,21,76,19],[82,24,76,22],[82,28,76,26,"_LeastSquareSolver"],[82,46,76,44],[82,47,76,45,"default"],[82,54,76,52],[82,55,76,53,"time"],[82,59,76,57],[82,61,76,59,"x"],[82,62,76,60],[82,64,76,62,"w"],[82,65,76,63],[82,66,76,64],[83,10,77,6],[83,14,77,12,"xFit"],[83,18,77,16],[83,21,77,19,"xSolver"],[83,28,77,26],[83,29,77,27,"solve"],[83,34,77,32],[83,35,77,33],[83,36,77,34],[83,37,77,35],[84,10,79,6],[84,14,79,10,"xFit"],[84,18,79,14],[84,23,79,19],[84,27,79,23],[84,29,79,25],[85,12,80,8],[85,16,80,14,"ySolver"],[85,23,80,21],[85,26,80,24],[85,30,80,28,"_LeastSquareSolver"],[85,48,80,46],[85,49,80,47,"default"],[85,56,80,54],[85,57,80,55,"time"],[85,61,80,59],[85,63,80,61,"y"],[85,64,80,62],[85,66,80,64,"w"],[85,67,80,65],[85,68,80,66],[86,12,81,8],[86,16,81,14,"yFit"],[86,20,81,18],[86,23,81,21,"ySolver"],[86,30,81,28],[86,31,81,29,"solve"],[86,36,81,34],[86,37,81,35],[86,38,81,36],[86,39,81,37],[87,12,83,8],[87,16,83,12,"yFit"],[87,20,83,16],[87,25,83,21],[87,29,83,25],[87,31,83,27],[88,14,84,10],[88,18,84,16,"xVelocity"],[88,27,84,25],[88,30,84,28,"xFit"],[88,34,84,32],[88,35,84,33,"coefficients"],[88,47,84,45],[88,48,84,46],[88,49,84,47],[88,50,84,48],[88,53,84,51],[88,57,84,55],[89,14,85,10],[89,18,85,16,"yVelocity"],[89,27,85,25],[89,30,85,28,"yFit"],[89,34,85,32],[89,35,85,33,"coefficients"],[89,47,85,45],[89,48,85,46],[89,49,85,47],[89,50,85,48],[89,53,85,51],[89,57,85,55],[90,14,86,10],[90,21,86,17],[90,22,86,18,"xVelocity"],[90,31,86,27],[90,33,86,29,"yVelocity"],[90,42,86,38],[90,43,86,39],[91,12,87,8],[92,10,88,6],[93,8,89,4],[94,8,91,4],[94,15,91,11],[94,19,91,15],[95,6,92,2],[96,4,92,3],[97,6,92,3,"key"],[97,9,92,3],[98,6,92,3,"value"],[98,11,92,3],[98,13,94,2],[98,22,94,2,"getVelocity"],[98,33,94,13,"getVelocity"],[98,34,94,13],[98,36,94,16],[99,8,95,4],[99,12,95,10,"estimate"],[99,20,95,18],[99,23,95,21],[99,27,95,25],[99,28,95,26,"getVelocityEstimate"],[99,47,95,45],[99,48,95,46],[99,49,95,47],[100,8,97,4],[100,12,97,8,"estimate"],[100,20,97,16],[100,25,97,21],[100,29,97,25],[100,31,97,27],[101,10,98,6],[101,17,98,13,"estimate"],[101,25,98,21],[102,8,99,4],[103,8,101,4],[103,15,101,11],[103,16,101,12],[103,17,101,13],[103,19,101,15],[103,20,101,16],[103,21,101,17],[104,6,102,2],[105,4,102,3],[106,6,102,3,"key"],[106,9,102,3],[107,6,102,3,"value"],[107,11,102,3],[107,13,104,2],[107,22,104,2,"reset"],[107,27,104,7,"reset"],[107,28,104,7],[107,30,104,10],[108,8,105,4],[108,12,105,8],[108,13,105,9,"samples"],[108,20,105,16],[108,21,105,17,"clear"],[108,26,105,22],[108,27,105,23],[108,28,105,24],[109,6,106,2],[110,4,106,3],[111,2,106,3],[112,2,110,0,"exports"],[112,9,110,7],[112,10,110,8,"default"],[112,17,110,15],[112,20,110,18,"VelocityTracker"],[112,35,110,33],[113,0,110,34]],"functionMap":{"names":["<global>","_interopRequireDefault","_defineProperty","VelocityTracker","constructor","add","getVelocityEstimate","getVelocity","reset"],"mappings":"AAA;ACW,+FD;AEE,iNF;AGE;ECC;GDY;EEE;GFE;EGQ;GHmD;EIE;GJQ;EKE;GLE;CHE"}},"type":"js/module"}]}