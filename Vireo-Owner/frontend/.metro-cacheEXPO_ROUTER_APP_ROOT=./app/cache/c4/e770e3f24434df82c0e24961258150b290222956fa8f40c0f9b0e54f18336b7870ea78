{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":98,"column":43,"index":2680}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":98,"column":43,"index":2680}}],"key":"ohGilxjVqjyE1GooDVDt9OYg9x0="}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":98,"column":43,"index":2680}}],"key":"V6GYoXnblvuuGHJNMy7MHyaunsU="}},{"name":"./CircularBuffer","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":211},"end":{"line":3,"column":46,"index":257}}],"key":"yhh9BZ23Anx9K68Ta7WcM9DWmpE="}},{"name":"./LeastSquareSolver","data":{"asyncType":null,"locs":[{"start":{"line":4,"column":0,"index":258},"end":{"line":4,"column":52,"index":310}}],"key":"EHof73iRGSr7O/L6wXn0Ha05yYU="}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _classCallCheck2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/classCallCheck\"));\n  var _createClass2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"@babel/runtime/helpers/createClass\"));\n  var _CircularBuffer = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"./CircularBuffer\"));\n  var _LeastSquareSolver = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"./LeastSquareSolver\"));\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n    return obj;\n  }\n  var VelocityTracker = exports.default = /*#__PURE__*/function () {\n    function VelocityTracker() {\n      (0, _classCallCheck2.default)(this, VelocityTracker);\n      _defineProperty(this, \"assumePointerMoveStoppedMilliseconds\", 40);\n      _defineProperty(this, \"historySize\", 20);\n      _defineProperty(this, \"horizonMilliseconds\", 300);\n      _defineProperty(this, \"minSampleSize\", 3);\n      _defineProperty(this, \"samples\", void 0);\n      this.samples = new _CircularBuffer.default(this.historySize);\n    }\n    return (0, _createClass2.default)(VelocityTracker, [{\n      key: \"add\",\n      value: function add(event) {\n        this.samples.push(event);\n      } // Returns an estimate of the velocity of the object being tracked by the\n      // tracker given the current information available to the tracker.\n      //\n      // Information is added using [addPosition].\n      //\n      // Returns null if there is no data on which to base an estimate.\n    }, {\n      key: \"getVelocityEstimate\",\n      value: function getVelocityEstimate() {\n        var x = [];\n        var y = [];\n        var w = [];\n        var time = [];\n        var sampleCount = 0;\n        var index = this.samples.size - 1;\n        var newestSample = this.samples.get(index);\n        if (!newestSample) {\n          return null;\n        }\n        var previousSample = newestSample; // Starting with the most recent PointAtTime sample, iterate backwards while\n        // the samples represent continuous motion.\n\n        while (sampleCount < this.samples.size) {\n          var sample = this.samples.get(index);\n          var age = newestSample.time - sample.time;\n          var delta = Math.abs(sample.time - previousSample.time);\n          previousSample = sample;\n          if (age > this.horizonMilliseconds || delta > this.assumePointerMoveStoppedMilliseconds) {\n            break;\n          }\n          x.push(sample.x);\n          y.push(sample.y);\n          w.push(1);\n          time.push(-age);\n          sampleCount++;\n          index--;\n        }\n        if (sampleCount >= this.minSampleSize) {\n          var xSolver = new _LeastSquareSolver.default(time, x, w);\n          var xFit = xSolver.solve(2);\n          if (xFit !== null) {\n            var ySolver = new _LeastSquareSolver.default(time, y, w);\n            var yFit = ySolver.solve(2);\n            if (yFit !== null) {\n              var xVelocity = xFit.coefficients[1] * 1000;\n              var yVelocity = yFit.coefficients[1] * 1000;\n              return [xVelocity, yVelocity];\n            }\n          }\n        }\n        return null;\n      }\n    }, {\n      key: \"velocity\",\n      get: function get() {\n        var estimate = this.getVelocityEstimate();\n        if (estimate !== null) {\n          return estimate;\n        }\n        return [0, 0];\n      }\n    }, {\n      key: \"reset\",\n      value: function reset() {\n        this.samples.clear();\n      }\n    }]);\n  }();\n});","lineCount":106,"map":[[9,2,3,0],[9,6,3,0,"_CircularBuffer"],[9,21,3,0],[9,24,3,0,"_interopRequireDefault"],[9,46,3,0],[9,47,3,0,"_$$_REQUIRE"],[9,58,3,0],[9,59,3,0,"_dependencyMap"],[9,73,3,0],[10,2,4,0],[10,6,4,0,"_LeastSquareSolver"],[10,24,4,0],[10,27,4,0,"_interopRequireDefault"],[10,49,4,0],[10,50,4,0,"_$$_REQUIRE"],[10,61,4,0],[10,62,4,0,"_dependencyMap"],[10,76,4,0],[11,2,1,0],[11,11,1,9,"_defineProperty"],[11,26,1,24,"_defineProperty"],[11,27,1,25,"obj"],[11,30,1,28],[11,32,1,30,"key"],[11,35,1,33],[11,37,1,35,"value"],[11,42,1,40],[11,44,1,42],[12,4,1,44],[12,8,1,48,"key"],[12,11,1,51],[12,15,1,55,"obj"],[12,18,1,58],[12,20,1,60],[13,6,1,62,"Object"],[13,12,1,68],[13,13,1,69,"defineProperty"],[13,27,1,83],[13,28,1,84,"obj"],[13,31,1,87],[13,33,1,89,"key"],[13,36,1,92],[13,38,1,94],[14,8,1,96,"value"],[14,13,1,101],[14,15,1,103,"value"],[14,20,1,108],[15,8,1,110,"enumerable"],[15,18,1,120],[15,20,1,122],[15,24,1,126],[16,8,1,128,"configurable"],[16,20,1,140],[16,22,1,142],[16,26,1,146],[17,8,1,148,"writable"],[17,16,1,156],[17,18,1,158],[18,6,1,163],[18,7,1,164],[18,8,1,165],[19,4,1,167],[19,5,1,168],[19,11,1,174],[20,6,1,176,"obj"],[20,9,1,179],[20,10,1,180,"key"],[20,13,1,183],[20,14,1,184],[20,17,1,187,"value"],[20,22,1,192],[21,4,1,194],[22,4,1,196],[22,11,1,203,"obj"],[22,14,1,206],[23,2,1,208],[24,2,1,209],[24,6,5,21,"VelocityTracker"],[24,21,5,36],[24,24,5,36,"exports"],[24,31,5,36],[24,32,5,36,"default"],[24,39,5,36],[25,4,6,2],[25,13,6,2,"VelocityTracker"],[25,29,6,2],[25,31,6,16],[26,6,6,16],[26,10,6,16,"_classCallCheck2"],[26,26,6,16],[26,27,6,16,"default"],[26,34,6,16],[26,42,6,16,"VelocityTracker"],[26,57,6,16],[27,6,7,4,"_defineProperty"],[27,21,7,19],[27,22,7,20],[27,26,7,24],[27,28,7,26],[27,66,7,64],[27,68,7,66],[27,70,7,68],[27,71,7,69],[28,6,9,4,"_defineProperty"],[28,21,9,19],[28,22,9,20],[28,26,9,24],[28,28,9,26],[28,41,9,39],[28,43,9,41],[28,45,9,43],[28,46,9,44],[29,6,11,4,"_defineProperty"],[29,21,11,19],[29,22,11,20],[29,26,11,24],[29,28,11,26],[29,49,11,47],[29,51,11,49],[29,54,11,52],[29,55,11,53],[30,6,13,4,"_defineProperty"],[30,21,13,19],[30,22,13,20],[30,26,13,24],[30,28,13,26],[30,43,13,41],[30,45,13,43],[30,46,13,44],[30,47,13,45],[31,6,15,4,"_defineProperty"],[31,21,15,19],[31,22,15,20],[31,26,15,24],[31,28,15,26],[31,37,15,35],[31,39,15,37],[31,44,15,42],[31,45,15,43],[31,46,15,44],[32,6,17,4],[32,10,17,8],[32,11,17,9,"samples"],[32,18,17,16],[32,21,17,19],[32,25,17,23,"CircularBuffer"],[32,48,17,37],[32,49,17,38],[32,53,17,42],[32,54,17,43,"historySize"],[32,65,17,54],[32,66,17,55],[33,4,18,2],[34,4,18,3],[34,15,18,3,"_createClass2"],[34,28,18,3],[34,29,18,3,"default"],[34,36,18,3],[34,38,18,3,"VelocityTracker"],[34,53,18,3],[35,6,18,3,"key"],[35,9,18,3],[36,6,18,3,"value"],[36,11,18,3],[36,13,20,2],[36,22,20,2,"add"],[36,25,20,5,"add"],[36,26,20,6,"event"],[36,31,20,11],[36,33,20,13],[37,8,21,4],[37,12,21,8],[37,13,21,9,"samples"],[37,20,21,16],[37,21,21,17,"push"],[37,25,21,21],[37,26,21,22,"event"],[37,31,21,27],[37,32,21,28],[38,6,22,2],[38,7,22,3],[38,8,22,4],[39,6,23,2],[40,6,24,2],[41,6,25,2],[42,6,26,2],[43,6,27,2],[44,4,27,2],[45,6,27,2,"key"],[45,9,27,2],[46,6,27,2,"value"],[46,11,27,2],[46,13,30,2],[46,22,30,2,"getVelocityEstimate"],[46,41,30,21,"getVelocityEstimate"],[46,42,30,21],[46,44,30,24],[47,8,31,4],[47,12,31,10,"x"],[47,13,31,11],[47,16,31,14],[47,18,31,16],[48,8,32,4],[48,12,32,10,"y"],[48,13,32,11],[48,16,32,14],[48,18,32,16],[49,8,33,4],[49,12,33,10,"w"],[49,13,33,11],[49,16,33,14],[49,18,33,16],[50,8,34,4],[50,12,34,10,"time"],[50,16,34,14],[50,19,34,17],[50,21,34,19],[51,8,35,4],[51,12,35,8,"sampleCount"],[51,23,35,19],[51,26,35,22],[51,27,35,23],[52,8,36,4],[52,12,36,8,"index"],[52,17,36,13],[52,20,36,16],[52,24,36,20],[52,25,36,21,"samples"],[52,32,36,28],[52,33,36,29,"size"],[52,37,36,33],[52,40,36,36],[52,41,36,37],[53,8,37,4],[53,12,37,10,"newestSample"],[53,24,37,22],[53,27,37,25],[53,31,37,29],[53,32,37,30,"samples"],[53,39,37,37],[53,40,37,38,"get"],[53,43,37,41],[53,44,37,42,"index"],[53,49,37,47],[53,50,37,48],[54,8,39,4],[54,12,39,8],[54,13,39,9,"newestSample"],[54,25,39,21],[54,27,39,23],[55,10,40,6],[55,17,40,13],[55,21,40,17],[56,8,41,4],[57,8,43,4],[57,12,43,8,"previousSample"],[57,26,43,22],[57,29,43,25,"newestSample"],[57,41,43,37],[57,42,43,38],[57,43,43,39],[58,8,44,4],[60,8,46,4],[60,15,46,11,"sampleCount"],[60,26,46,22],[60,29,46,25],[60,33,46,29],[60,34,46,30,"samples"],[60,41,46,37],[60,42,46,38,"size"],[60,46,46,42],[60,48,46,44],[61,10,47,6],[61,14,47,12,"sample"],[61,20,47,18],[61,23,47,21],[61,27,47,25],[61,28,47,26,"samples"],[61,35,47,33],[61,36,47,34,"get"],[61,39,47,37],[61,40,47,38,"index"],[61,45,47,43],[61,46,47,44],[62,10,48,6],[62,14,48,12,"age"],[62,17,48,15],[62,20,48,18,"newestSample"],[62,32,48,30],[62,33,48,31,"time"],[62,37,48,35],[62,40,48,38,"sample"],[62,46,48,44],[62,47,48,45,"time"],[62,51,48,49],[63,10,49,6],[63,14,49,12,"delta"],[63,19,49,17],[63,22,49,20,"Math"],[63,26,49,24],[63,27,49,25,"abs"],[63,30,49,28],[63,31,49,29,"sample"],[63,37,49,35],[63,38,49,36,"time"],[63,42,49,40],[63,45,49,43,"previousSample"],[63,59,49,57],[63,60,49,58,"time"],[63,64,49,62],[63,65,49,63],[64,10,50,6,"previousSample"],[64,24,50,20],[64,27,50,23,"sample"],[64,33,50,29],[65,10,52,6],[65,14,52,10,"age"],[65,17,52,13],[65,20,52,16],[65,24,52,20],[65,25,52,21,"horizonMilliseconds"],[65,44,52,40],[65,48,52,44,"delta"],[65,53,52,49],[65,56,52,52],[65,60,52,56],[65,61,52,57,"assumePointerMoveStoppedMilliseconds"],[65,97,52,93],[65,99,52,95],[66,12,53,8],[67,10,54,6],[68,10,56,6,"x"],[68,11,56,7],[68,12,56,8,"push"],[68,16,56,12],[68,17,56,13,"sample"],[68,23,56,19],[68,24,56,20,"x"],[68,25,56,21],[68,26,56,22],[69,10,57,6,"y"],[69,11,57,7],[69,12,57,8,"push"],[69,16,57,12],[69,17,57,13,"sample"],[69,23,57,19],[69,24,57,20,"y"],[69,25,57,21],[69,26,57,22],[70,10,58,6,"w"],[70,11,58,7],[70,12,58,8,"push"],[70,16,58,12],[70,17,58,13],[70,18,58,14],[70,19,58,15],[71,10,59,6,"time"],[71,14,59,10],[71,15,59,11,"push"],[71,19,59,15],[71,20,59,16],[71,21,59,17,"age"],[71,24,59,20],[71,25,59,21],[72,10,60,6,"sampleCount"],[72,21,60,17],[72,23,60,19],[73,10,61,6,"index"],[73,15,61,11],[73,17,61,13],[74,8,62,4],[75,8,64,4],[75,12,64,8,"sampleCount"],[75,23,64,19],[75,27,64,23],[75,31,64,27],[75,32,64,28,"minSampleSize"],[75,45,64,41],[75,47,64,43],[76,10,65,6],[76,14,65,12,"xSolver"],[76,21,65,19],[76,24,65,22],[76,28,65,26,"LeastSquareSolver"],[76,54,65,43],[76,55,65,44,"time"],[76,59,65,48],[76,61,65,50,"x"],[76,62,65,51],[76,64,65,53,"w"],[76,65,65,54],[76,66,65,55],[77,10,66,6],[77,14,66,12,"xFit"],[77,18,66,16],[77,21,66,19,"xSolver"],[77,28,66,26],[77,29,66,27,"solve"],[77,34,66,32],[77,35,66,33],[77,36,66,34],[77,37,66,35],[78,10,68,6],[78,14,68,10,"xFit"],[78,18,68,14],[78,23,68,19],[78,27,68,23],[78,29,68,25],[79,12,69,8],[79,16,69,14,"ySolver"],[79,23,69,21],[79,26,69,24],[79,30,69,28,"LeastSquareSolver"],[79,56,69,45],[79,57,69,46,"time"],[79,61,69,50],[79,63,69,52,"y"],[79,64,69,53],[79,66,69,55,"w"],[79,67,69,56],[79,68,69,57],[80,12,70,8],[80,16,70,14,"yFit"],[80,20,70,18],[80,23,70,21,"ySolver"],[80,30,70,28],[80,31,70,29,"solve"],[80,36,70,34],[80,37,70,35],[80,38,70,36],[80,39,70,37],[81,12,72,8],[81,16,72,12,"yFit"],[81,20,72,16],[81,25,72,21],[81,29,72,25],[81,31,72,27],[82,14,73,10],[82,18,73,16,"xVelocity"],[82,27,73,25],[82,30,73,28,"xFit"],[82,34,73,32],[82,35,73,33,"coefficients"],[82,47,73,45],[82,48,73,46],[82,49,73,47],[82,50,73,48],[82,53,73,51],[82,57,73,55],[83,14,74,10],[83,18,74,16,"yVelocity"],[83,27,74,25],[83,30,74,28,"yFit"],[83,34,74,32],[83,35,74,33,"coefficients"],[83,47,74,45],[83,48,74,46],[83,49,74,47],[83,50,74,48],[83,53,74,51],[83,57,74,55],[84,14,75,10],[84,21,75,17],[84,22,75,18,"xVelocity"],[84,31,75,27],[84,33,75,29,"yVelocity"],[84,42,75,38],[84,43,75,39],[85,12,76,8],[86,10,77,6],[87,8,78,4],[88,8,80,4],[88,15,80,11],[88,19,80,15],[89,6,81,2],[90,4,81,3],[91,6,81,3,"key"],[91,9,81,3],[92,6,81,3,"get"],[92,9,81,3],[92,11,83,2],[92,20,83,2,"get"],[92,24,83,2],[92,26,83,17],[93,8,84,4],[93,12,84,10,"estimate"],[93,20,84,18],[93,23,84,21],[93,27,84,25],[93,28,84,26,"getVelocityEstimate"],[93,47,84,45],[93,48,84,46],[93,49,84,47],[94,8,86,4],[94,12,86,8,"estimate"],[94,20,86,16],[94,25,86,21],[94,29,86,25],[94,31,86,27],[95,10,87,6],[95,17,87,13,"estimate"],[95,25,87,21],[96,8,88,4],[97,8,90,4],[97,15,90,11],[97,16,90,12],[97,17,90,13],[97,19,90,15],[97,20,90,16],[97,21,90,17],[98,6,91,2],[99,4,91,3],[100,6,91,3,"key"],[100,9,91,3],[101,6,91,3,"value"],[101,11,91,3],[101,13,93,2],[101,22,93,2,"reset"],[101,27,93,7,"reset"],[101,28,93,7],[101,30,93,10],[102,8,94,4],[102,12,94,8],[102,13,94,9,"samples"],[102,20,94,16],[102,21,94,17,"clear"],[102,26,94,22],[102,27,94,23],[102,28,94,24],[103,6,95,2],[104,4,95,3],[105,2,95,3],[106,0,95,3]],"functionMap":{"names":["_defineProperty","<global>","VelocityTracker","constructor","add","getVelocityEstimate","get__velocity","reset"],"mappings":"AAA,iNC;eCI;ECC;GDY;EEE;GFE;EGQ;GHmD;EIE;GJQ;EKE;GLE;CDE"}},"type":"js/module"}]}